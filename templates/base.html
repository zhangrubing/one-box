<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>!function(){try{var t=localStorage.getItem("theme");if(!t){t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark"}document.documentElement.setAttribute("data-theme",t)}catch(e){}}();</script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>tailwind.config={darkMode:["class","[data-theme='dark']"]}</script>
  <link rel="stylesheet" href="{{ url_for('static', path='assets/style.css?v=1') }}">
  <link rel="stylesheet" href="{{ url_for('static', path='assets/overrides.css') }}">
  <title>ä¸€ä½“æœºç›‘æ§ - {{ page_title or '' }}</title>
</head>
<body>
<div class="container">
  <aside class="sidebar">
    <div class="brand"><img src="{{ url_for('static', path='assets/logo.svg') }}" alt="logo"> <span>è‹±æ™º Â· ä¸€ä½“æœºç›‘æ§</span></div>
    <div class="side-caption">OBM-å•æœºç‰ˆ</div>
    <nav class="nav">
      {% set navs = [
        ('/dashboard','ä»ªè¡¨ç›˜','home','m-home'),
        ('/hardware','ç¡¬ä»¶åŠç³»ç»Ÿ','chip','m-hardware'),
        ('/gpu','GPUè¯¦æƒ…','gpu','m-gpu'),
        ('/network','ç½‘ç»œæ¥å£','net','m-network'),
        ('/storage','å­˜å‚¨ä¸ç£ç›˜','drive','m-storage'),
        ('/alerts','å‘Šè­¦ä¸­å¿ƒ','alert','m-alerts'),
        ('/operations','è¿ç»´æ“ä½œ','terminal','m-operations'),
        ('/users','ç”¨æˆ·ç®¡ç†','user','m-users'),
        ('/reports','æ•°æ®æŠ¥è¡¨','report','m-reports'),
        ('/logs','ç³»ç»Ÿæ—¥å¿—','logs','m-logs'),
        ('/audit','å®¡è®¡æ—¥å¿—','audit','m-audit'),
        ('/about','å…³äº','about','m-about')
      ] %}
      {% for href,label,icon,klass in navs %}
        <a href="{{ href }}" class="{{ 'active' if request.url.path==href else '' }} {{ klass }}">
          <svg class="ico"><use href="{{ url_for('static', path='assets/icons.svg') }}#{{ icon }}"></use></svg>
          <span>{{ label }}</span>
        </a>
      {% endfor %}
    </nav>
    <div class="footer">ç‰ˆæœ¬ï¼š{{ env }}<br>ç™»å½•ç”¨æˆ·ï¼š{{ user.username if user else '-' }}</div>
  </aside>
  <main>
    <div class="header">
      <div><strong>{{ page_title or '' }}</strong></div>
      <div class="flex">
        <button class="btn secondary" id="theme-toggle">ğŸŒ“ ä¸»é¢˜</button>
        <button class="btn danger" onclick="logout()">é€€å‡º</button>
      </div>
    </div>
    <div class="content">{% block content %}{% endblock %}</div>
  </main>
</div>
<script type="module">
import { logout } from "{{ url_for('static', path='assets/common.js') }}"; window.logout=logout;
const KEY='theme'; const btn=document.getElementById('theme-toggle');
function setT(t){ document.documentElement.setAttribute('data-theme',t); try{localStorage.setItem(KEY,t);}catch(e){} }
function getT(){ return document.documentElement.getAttribute('data-theme')||'dark'; }
btn?.addEventListener('click', ()=>{ setT(getT()==='dark'?'light':'dark'); });
try{
  const saved=localStorage.getItem(KEY); const mq=window.matchMedia('(prefers-color-scheme: light)');
  mq.addEventListener?.('change', e=>{ if(!saved) setT(e.matches?'light':'dark'); });
}catch(e){}
</script>
</body>
</html>
